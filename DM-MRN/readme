# Multistage Relation Network With Dual-Metric for Few-Shot Hyperspectral Image Classification

This demo shows the DM-MRN model in ["Multistage Relation Network With Dual-Metric for Few-Shot Hyperspectral Image Classification"](https://ieeexplore.ieee.org/document/10111060).
More specifically, it is detailed as follow.

     train.py ······A script executing model training.
     test.py  ······A script executing model tests.
     tools.py ······A script implementing the data preprocessing, result saving and etc.
     net.py  ······A script implementing the DM-MRN model.
     /Datasets:  ······Including the PU, SA, HHK, Berlin and HU2018 data sets.
          /PaviaU
               PaviaU.mat
               PaviaU_gt.mat
     /Results:       
          /Accu_file  ······For storing test results.
          /Checkpoints  ······For storing training parameters.
          /Losses  ······For storing the loss value.
          /Pic  ······For storing the prediction map.
          /SampleSplit  ······For storing training samples and test samples.


Citation
---------------------

**Please kindly cite the papers if this code is useful and helpful for your research.**

J. Zeng, Z. Xue, L. Zhang, Q. Lan and M. Zhang, "Multistage Relation Network With Dual-Metric for Few-Shot Hyperspectral Image Classification," in IEEE Transactions on Geoscience and Remote Sensing, vol. 61, pp. 1-17, 2023, Art no. 5510017, doi: 10.1109/TGRS.2023.3271424. 


Required core python libraries
---------------------
     1. python 3.8  
     2. pytorch >= 1.7.0  
     3. scipy >= 1.9.1  
     4. sklearn >= 1.1.2 
     5. matplotlib >= 3.5.2  
     6. tqdm >= 4.64.1 


Copyright & Disclaimer
---------

The programs contained in this package are granted free of charge for research and education purposes only. 

